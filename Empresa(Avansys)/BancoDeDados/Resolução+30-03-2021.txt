 -- Resolução da Atividade 30/03/2021

-- 1. nome e CPF dos médicos que também são pacientes do hospital

         select m.nome, m.cpf from Medicos as m 
         inner join Pacientes as p on m.nome = p.nome;
  
-- 2. pares (código, nome) de funcionários e de médicos que residem na mesma cidade

         select f.nome, f.codf from Funcionarios as f
         inner join Medicos as m on f.cidade = m.cidade;
   
-- 3.  código e nome dos pacientes com consulta marcada para horários após às 14 horas
		 
		 select p.codp, p.nome, c.hora from Pacientes as p
		 inner join Consultas as c on p.codp = c.codp
		 where hora > '14:00';
		 
-- 4.  número e andar dos ambulatórios utilizados por médicos ortopedistas

		 select a.nroa, a.andar from Ambulatorios as a
		 inner join Medicos as m on a.nroa = m.nroa 
		 where especialidade = 'ortopedia';
		 
-- 5. nome e CPF dos pacientes que têm consultas marcadas entre os dias 14 e 16 de junho de 2006

         select p.nome, p.Cpf, c.data from Pacientes as p
		 inner join Consultas as c on p.codp = c.codp
		 where data between'14/06/2006' and '16/06/2006';
		 
-- 6.  nome e idade dos médicos que têm consulta com a paciente Ana

         select m.nome, m.idade from Medicos as m
		 inner join Consultas as c on m.codm = c.codm
		 inner join Pacientes as p on c.codp = p.codp
		 where p.nome = 'Ana';
		 
-- 7. código e nome dos médicos que atendem no mesmo ambulatório do médico Pedro e
--que possuem consultas marcadas para dia 14/06/2006

         select distinct m.codm, m.nome from Medicos as m inner join Ambulatorios as a on
         m.nroa = a.nroa inner join Consultas as c on
         m.codm = c.codm inner join Pacientes p on c.codp = p.codp
         where c.data = '2006-06-14'
         and a.nroa in (
			 
          select a.nroa from Medicos as m 
	      inner join Ambulatorios as a on m.nroa = a.nroa
	      inner join Consultas c on m.codm = c.codm where m.nome = 'Pedro'
         );
		 
-- 8.  nome, CPF e idade dos pacientes que têm consultas marcadas com ortopedistas
 -- para dias anteriores ao dia 16	
 
         select p.nome,p.Cpf from Pacientes as p
		 inner join Consultas as c on p.codp = c.codp
		 inner join Medicos as m on c.codm = m.codm
		 where m.especialidade = 'ortopedia' and extract (day from c.data) < 16;
		 
 -- 9. nome e salário dos funcionários que moram na mesma cidade do funcionário Carlos
 -- e possuem salário superior ao dele
 
         select f.nome, f.salario from Funcionarios as f
		 where f.cidade ='Florianopolis' and f.salario > 1200;
		 
-- 10. dados de todos os ambulatórios e, para aqueles ambulatórios onde médicos dão
-- atendimento, exibir também os seus códigos e nomes	 

         select distinct a.nroa, a.andar, a.capacidade, m.nome, m.Cpf  from Ambulatorios as a
		 inner join Medicos as m on a.nroa = m.nroa
		 inner join Consultas as c on m.codm = c.codm where m.codm is not null;
		 
-- 11.   CPF e nome de todos os médicos e, para aqueles médicos com consultas
--       marcadas, exibir os CPFs e nomes dos seus pacientes e as datas das consultas	

          select m.Cpf, m.nome, p.Cpf, p.nome, c.data from Medicos as m
		  inner join Consultas as c on c.codm = m.codm
		  inner join Pacientes as p on c.codp = p.codp;